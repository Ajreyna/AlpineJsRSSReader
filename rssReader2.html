<!DOCTYPE html>
<html lang="eng">
    <head> 
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Alpine.Js RSS</title>

        <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/rss-parser@3.12.0/dist/rss-parser.min.js"></script>
    </head>
    <body>
        <style>
            h1 {
                color: rgba(187, 8, 8, 0.507);
                max-width: 38rem;
                padding: 2rem;
                margin: auto;    
                font-family:monospace;
                font-size: xx-large;  
                          
            }

            body {
                background-color: rgba(143, 64, 212, 0.272);
            }

            .ass {
             background-color: blanchedalmond;
             font-family: fantasy;
             font-size: x-large;
             font-weight: 500;
            }
            
        </style>
        <h1>Behind the Bastards Podcast</h1>
        <div x-data="setup()" x-init="init()">
            <template x-for="(entry, index) in feed" :key="index">

                <div class="ass" x-bind:href="entry.link" x-data="{ open:false }">
                    <p>
                        <span x-text="entry.title" x-text="entry.pubDate"></span>
                    </p>
                    
                    <button @click="open = ! open">CLICK HERE FOR EXCELLENCE</button>

                    <div x-show="open">
                        <div> 
                           <span x-text="entry.title"></span> <a x-bind:href="entry.link" x-text="entry.link" ></a>
                       </div>
                    </div>

                
                    
                </div>
            </template>
        </div>

       <script>
        //const CORS_PROXY = "https://cors-anywhere.herokuapp.com/"
        let parser = new RSSParser()

        customFields: {
            feed: ['']
        }

        function setup () {
            return {
                feed: [],

                sources: [
                    //'https://www.rtl-sdr.com/sdrsharp-big-guide-book-updated-to-v5-3',
                    'https://omnycontent.com/d/playlist/e73c998e-6e60-432f-8610-ae210140c5b1/E5F91208-CC7E-4726-A312-AE280140AD11/D64F756D-6D5E-4FAE-B24F-AE280140AD36/podcast.rss'
                ],

                get (source) {
                    parser.parseURL(source,(err, feed) => {
                        if (err) {}

                        feed.items.forEach(entry => {
                            this.addToFeed(entry)
                            
                        });
                    })
                },

                addToFeed (entry) {
                    this.feed.push({
                        title: entry.title,
                        link: entry.link,
                        
                        date: new Date(entry.pubDate),
                    })
                },

                init () {
                    this.sources.forEach(source => {
                        this.get(source)
                    })
                }

              
            }
        }
        
       </script>
    </body>
</html>